<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" type="image/ico" href="../static/images/favicon.ico">
    <title>the shop. | Home</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="{{ url_for('static', filename='homepage.css')}}">
</head>

<body>
    <header>
        <!-- <img class="logo" src="{{url_for('static', filename='images/logo_goes_here.png')}}" alt="logo"> -->
        <div class="container">
            <nav class="navbar">
                <a href="/" class="fs-2">the shop.</a>
                <ul class="nav-links">
                    <li><a href="/login" class="fs-5">Login</a></li>
                    <!-- <li><a href="/cart" class="fs-5" >Cart</a></li> -->
                    <li>
                        <div class="cart">
                            <button type="button" id="cart-btn">
                                <i class="fas fa-shopping-cart"></i>
                                <span id="cart-count-info"></span>
                            </button>
                            <div class="cart-container">
                                <div class="cart-list"></div>
                                <div class="cart-total">
                                    <h3>Total: $</h3>
                                    <span id="cart-total-value"></span>
                                </div>
                                <div class="d-grid gap-2 col-4 mx-auto my-3">
                                    <button class="btn btn-primary" type="button">Pay Now</button>
                                </div>

                            </div>
                        </div>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <section>
        <div class="container pb-5 px-lg-5" id="main-container">
            <h2 class="text-center m-4">Daily Discover</h2>
            <!-- <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 px-md-5" id="productCards"></div> -->
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 px-md-5" id="product-list"></div>
        </div>
    </section>

    <!-- <script>
        // Helper function to display error message
        function showError(message) {
            // Hide the table and button in the event of error
            $('#main-container').hide();
            // $('#addBookBtn').hide();

            // Display an error under the main container
            $('#main-container')
            .append("<label>" + message + "</label>");
        }


        $(async () => {
            var serviceURL = "http://127.0.0.1:9090/items";
            try {
                const response =
                    await fetch(
                        serviceURL, { method: 'GET' }
                    );
                const result = await response.json();
                if (response.status === 200) {
                    // success case
                    var items = result;
                    window.localStorage.setItem("items", JSON.stringify(items))
                    items.forEach(item => {
                        var imgFileName = "static/images/" + item.id + "-1.jpeg";
                        card=`<div class="col">
                                <div class="card shadow-sm">
                                    <img class="card-img-top bg-dark cover" id="shop-item-image" alt="${item.productName}" src=${imgFileName}>
                                    <div class="card-body">
                                        <h5 class="card-title text-center" id="shop-item-title">${item.productName}</h5>
                                        <p class="card-text text-center text-muted" id="shop-item-price">SGD ${item.itemPrice}</p>
                                        <div class="d-grid gap-2">
                                            <a href="/productDetails/${item.id}" class="btn btn-outline-dark"">Details</a>
                                            <button class="btn btn-primary shop-item-button" type="button">Add to Cart</button>
                                            <button class="btn btn-success" type="button">Pay Now</button>
                                        </div>
                                    </div>
                                </div>
                            </div>`;
                        document.getElementById("product-list").innerHTML += card;
                    });
                } else if (response.status == 404) {
                    // No items
                    showError(result.message);
                } else {
                    // unexpected outcome, throw the error
                    throw response.status;
                }
            } catch (error) {
                // Errors when calling the service; such as network error,
                // service offline, etc
                showError
                    ('There is a problem retrieving product data, please try again later.<br />' + error);
            } // error
        });


    </script> -->

    <script src="https://kit.fontawesome.com/b7cadf2b6a.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

    <script src="../static/app.js" ></script>

</body>

</html>