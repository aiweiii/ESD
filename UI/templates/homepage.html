<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="{{ url_for('static', filename='homepage.css')}}">
</head>

<body>
    <!-- header contains the top bar: logo, search bar, login, cart -->
    <header>
        <img class="logo" src="../images/logo_goes_here.png" alt="logo">
        <nav>
            <ul class="nav-links">
                <li class="searchbar">
                    <input type="text" placeholder="Search">
                    <a href="#"><i class="fa-solid fa-magnifying-glass"></i></a>
                </li>
                <li><a href="#">Login</a></li>
                <li><a href="#">Cart</a></li>
            </ul>
        </nav>
    </header>

    <section>
        <div class="container">
            <div class="title">
                <h2>Daily Discover</h2>
                <hr>
            </div>
            <div class="row justify-content-center" id="productCards">
                <!-- <div class="card m-2 shadow" style="width: 15rem;">
                    <img src="image/towel.jpeg" class="card-img-top mt-3" alt="Face Towel">
                    <div class="card-body">
                        <h5 class="card-title">Face Towel</h5>
                        <p class="card-text my-4">SGD 7.90</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div> -->
            </div>
            <!-- <div class="row justify-content-center">
                <div class="card m-2 shadow" style="width: 15rem;">
                    <img src="image/towel.jpeg" class="card-img-top mt-3" alt="Face Towel">
                    <div class="card-body">
                        <h5 class="card-title">Face Towel</h5>
                        <p class="card-text my-4">SGD 7.90</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card m-2 shadow" style="width: 15rem;">
                    <img src="image/ottoman.jpeg" class="card-img-top mt-3" alt="Ottoman">
                    <div class="card-body">
                        <h5 class="card-title">Ottoman</h5>
                        <p class="card-text my-4">SGD 129.00</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card m-2 shadow" style="width: 15rem;">
                    <img src="image/slippers.jpeg" class="card-img-top mt-3" alt="Jersey Slippers">
                    <div class="card-body">
                        <h5 class="card-title">Jersey Slippers</h5>
                        <p class="card-text my-4">SGD 7.90</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
                <div class="card m-2 shadow" style="width: 15rem;">
                    <img src="image/mattress.jpeg" class="card-img-top mt-3" alt="Mattress">
                    <div class="card-body">
                        <h5 class="card-title">Mattress</h5>
                        <p class="card-text my-4">SGD 729.00</p>
                        <a href="#" class="btn btn-primary">Add To Cart</a>
                    </div>
                </div>
            </div> -->

            <div id="main-container" class="container">
                <h1 class="display-4">Book Listing</h1>
                <table class='table table-striped border-1'>
                    <thead class='table-dark'>
                        <tr>
                            <th>Title</th>
                            <th>ISBN 13</th>
                            <th>Price</th>
                            <th>Availability</th>
                        </tr>
                    </thead>
                    <tbody id="booksTable"></tbody>
                </table>
                <a id="addBookBtn" class="btn btn-primary" href="add-book.html">Add a book</a>
            </div>

        </div>
    </section>

    <script>
        // Helper function to display error message
        function showError(message) {
            // Hide the table and button in the event of error
            $('#booksTable').hide();
            // $('#addBookBtn').hide();

            // Display an error under the main container
            // $('#main-container')
            //   .append("<label>" + message + "</label>");
        }

        $(async () => {
            // Change serviceURL to your own
            var serviceURL = "http://127.0.0.1:9090/items";

            try {
                const response =
                    await fetch(
                        serviceURL, { method: 'GET' }
                    );
                const result = await response.json();
                if (response.status === 200) {
                    // success case
                    var items = result; //the array is in books within data of
                    // the returned result
                    // for loop to setup all table rows with obtained book data
                    items.forEach(item => {
                        card=`<div class="card m-2 shadow" style="width: 15rem;">
                                <img src="../images/1-1.jpeg" class="card-img-top mt-3" alt="${item.productName}">
                                    <div class="card-body">
                                        <h5 class="card-title">${item.productName}</h5>
                                        <p class="card-text my-4">SGD ${item.itemPrice}</p>
                                        <a href="#" class="btn btn-primary">Add To Cart</a>
                                    </div>
                                </div>
                            </div>`;

                        document.getElementById("productCards").innerHTML += card;
                    });

                    // document.getElementById("productCards").innerHTML = allCards;
                    // var rows = "";
                    // for (const item of items) {
                    //     card = `<td>" + ${item.productName} + "</td>" +
                    //         "<td>" + item.quantity + "</td>" +
                    //         "<td>" + item.itemPrice + "</td>" +
                    //         "<td>" + item.id + "</td>`;
                    //     rows += "<tr>" + card + "</tr>";
                    // }
                    // add all the rows to the table
                    // $('#productCards').append(allCards);

                } else if (response.status == 404) {
                    // No books
                    showError(result.message);
                } else {
                    // unexpected outcome, throw the error
                    throw response.status;
                }
            } catch (error) {
                // Errors when calling the service; such as network error,
                // service offline, etc
                showError
                    ('There is a problem retrieving books data, please try again later.<br />' + error);
            } // error
        });


    </script>


    <script src="https://kit.fontawesome.com/b7cadf2b6a.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

</body>

</html>